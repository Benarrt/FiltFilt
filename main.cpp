#include <iostream>
#include <chrono>

#include "FiltFilt.h"

int main(int argc, char **argv) 
{
	std::vector<double> b{
		    0.0675,
			0.1349,
			0.0675,
	};
	std::vector<double> a{
		    1.0000,
			-1.1430,
			0.4128,
	};
	std::vector<double> x{
		    -0.51581, 0.47506024, 0.74159921, 1.25673832, 0.95301848, 1.31038945, 1.32574021, 1.22461752, 1.44512431, 1.38272909, 0.88770664, 0.57975574, 0.97590929, 0.74717893, 0.2546045, -0.02145077, 0.04684786, -0.50877354, -0.21669095, -0.96287739, -0.79317997, -0.98905816, -1.44134198, -1.77615038, -1.26727393, -0.96529911, -0.63750665, 0.17067971, 0.67002014, 1.15125824, 1.4351731, 1.49188234, 1.08610441, 1.51674376, 1.03638119, 0.81466379, 1.22891895, 0.85854165, 0.92888442, 0.77742255, 0.60837669, 0.25846239, 0.45164096, -0.05677862, -0.2437064, -0.29777549, -0.60033604, -0.54867188, -0.98993111, -1.33683357, -1.13175165, -0.90444762, -0.95212336, -0.66761682, 0.19233868, 0.14398586, 0.79890427, 0.91577966, 1.09709596, 1.03687794, 0.87906316, 1.11044331, 1.01118504, 0.7682088, 0.61967551, 0.427363, 0.52604978, 0.43924446, 0.38228038, -0.02799047, -0.27694355, -0.38059388, -0.6287657, -0.63896432, -0.64611466, -0.81554808, -0.87854854, -1.24638874, -1.40013861, -1.1059747, -1.01485427, -0.5595182, -0.29703899, 0.2330044, 0.52339048, 0.57018693, 0.662334, 0.67740586, 1.23964211, 0.95877664, 0.93794633, 0.50687721, 0.5802369, 0.17723606, 0.07733726, 0.29145984, -0.0108806, -0.32143156, -0.23302095, -1.01051395, -0.75703684, -1.13440222, -1.12717102, -1.51276347, -1.62158244, -1.88839455, -1.76802896, -1.46915396, -0.99293437, -0.52767137, -0.16804265, 0.46097961, 0.64848634, 1.06757394, 1.05706931, 0.8105735, 0.82861002, 0.96526092, 0.9076096, 0.83629725, 0.7435481, 0.52574429, 0.33939068, 0.35341811, -0.43511405, 0.01170619, -0.21709634, -0.45854532, -0.71160472, -1.23710454, -1.22926603, -1.1951408, -1.46562724, -1.60905712, -1.18474291, -1.08485901, -0.2984206, 0.02758942, 0.61513949, 0.97884198, 0.70501268, 1.32106643, 0.66815441, 1.26644656, 1.34740681, 1.16548368, 1.05321285, 0.89290971, 0.54945839, 0.40935603, 0.42787297, 0.15797709, -0.2951045, -0.19791614, -0.55459538, -0.45487192, -0.77406616, -0.98113123, -1.13158988, -1.78287384, -1.97315751, -1.88766481, -1.93662125, -1.78414994, -1.2093083, -0.93694885, -0.25749629, -0.086662, 0.25508903, 0.48552225, 0.68441114, 0.52395785, 0.42730676, 0.69852939, 0.71352582, 0.31609175, 0.40865687, -0.0064239, -0.30450053, -0.12601019, -0.10877615, -0.09401104, -0.49897669, -0.65888054, -0.80834074, -0.71972642, -0.90957892, -0.93686798, -1.35508023, -0.95906057, -0.7024472, -0.6502612, -0.02001201, 0.22635603, 0.70900398, 0.93054695, 1.0520825, 0.57341123, 0.98713513, 0.77953359, 0.84441358, 0.97110129, 0.68100216, 0.28516629, 0.12602205, 0.26576884, 0.03522532, -0.10124312, -0.22422613, -0.45755062, -0.45182581, -0.82311496, -1.13159972, -1.32023524, -1.13908011, -1.34704804, -0.76137156, -0.54859328, -0.38058558, 0.22788317, 0.5588969, 0.6695042, 0.75666018, 0.84679791, 0.84354346, 0.93503486, 0.93590306, 0.71265983, 0.55678989, 0.34178679, 0.2583493, 0.0523166, 0.29425656, 0.09477453, -0.34965293, -0.03835998, -0.36542774, -1.14015463, -0.87185232, -1.16920731, -1.10933915, -1.02837801, -0.63615068, -0.49177759, 0.08743436, 0.63035843, 1.05926097, 0.96467613, 1.04475882, 0.86178947, 0.97697987, 1.16428003, 0.91149553, 1.40651872, 0.71075926, 0.49540267, 0.86579523, 0.61964756, 0.12167289, 0.28353061, -0.3155813, -0.49620766, -0.34342535, -0.49387889, -0.91441692, -1.25570737, -1.3956371, -1.58007746, -0.98091045, -0.83790156, -0.02446175, 0.16502944, 0.42695238, 1.39014372, 1.29743814, 1.26432153, 1.30620332, 1.48847695, 1.48701721, 1.350064, 1.22182245, 1.12781101, 1.20555897, 0.816712, 0.31132594, 0.36314387, -0.00689052, -0.0365793, -0.12665936, -0.403595, -0.62717748, -0.78285815, -1.03720214, -1.1350069, -1.19716158, -0.44698619, -0.3574304, -0.00841903, 0.35236705, 0.69625399, 1.21066325, 1.12855055, 1.34325877, 1.29811075, 1.41260242, 1.30145202, 1.12849674, 1.00741914, 0.60416783, 0.74192847, 0.38259373, 0.64444133, 0.42485102, 0.04239646, -0.20787522, -0.19266838, -0.36427378, -0.75552379, -0.96228798, -0.84021221, -1.16319195, -0.78623336, -0.52786248, -0.16306941, -0.05702346, 0.2026601, 0.64874787, 0.72558362, 0.50289036, 0.76290856, 0.67805915, 0.75212183, 0.60427024, 0.58367925, 0.83615675, 0.50169289, 0.42229614, 0.03236682, -0.03192849, -0.27302534, -0.62159403, -0.95904288, -1.07644192, -1.37847788, -0.9114043, -1.19786972, -1.33764367, -1.38546829, -1.3509235, -1.45620333, -0.71345886, -0.92563548, -0.60186333, 0.03445983, 0.38286458, 0.66670149, 0.76895234, 0.92530293, 0.75868067, 0.78691713, 1.15913462, 1.28880579, 1.15145569, 0.67132408, 0.46530261, 0.32711636, 0.42089078, 0.41606466, 0.171973, -0.32050372, -0.80553223, -0.90727945, -1.47898568, -1.34237637, -1.56640517, -1.12603848, -1.07701086, -0.58771841, -0.29625931, 0.44094315, 0.43885218, 0.80683401, 0.49077212, 0.22438992, 0.8587206, 0.83594155, 0.24764346, 0.3776693, 0.61691985, 0.40226693, 0.23312651, -0.16681334, -0.24911661, -0.77122499, -0.75799077, -1.01662804, -1.26488863, -1.44646955, -1.60246766, -1.78582026, -1.3334509, -1.16947214, -0.5409127, 0.07732528, 0.47542652, 0.97011578, 1.68779164, 1.29095454, 0.89660665, 1.23050307, 1.23845094, 1.12015183, 1.08549746, 0.93174053, 0.38209073, 0.30460029, 0.38668283, 0.02141184, -0.31832085, -0.70506149, -0.9184581, -0.92886625, -1.14954239, -1.97904095, -1.61040962, -1.48011551, -1.3321882, -1.20249224, -1.15136966, -0.39801283, 0.27064599, 0.87544227, 0.4588992, 0.97912449, 1.11150923, 0.87253078, 1.05985557, 0.57044856, 0.56462762, 0.62416968, 0.32251789, -0.01294232, -0.32382844, -0.59814727, -0.6944181, -1.10429519, -0.76313646, -1.08239799, -1.18707927, -1.35081679, -1.52883341, -1.26316962, -1.23882039, -0.81628578, -0.10061351, 0.13509245, 0.96103501, 0.74621456, 1.23708446, 0.76988225, 1.00472748, 0.85194125, 1.19866701, 0.47367789, 0.56249546, 0.48324597, 0.60834908, 0.24407184, 0.14735105, -0.01410986, -0.72008622, -0.47823556, -0.62646493, -0.83106914, -1.50868326, -1.47089711, -1.6994109, -1.42039467, -1.33248461, -0.54323568, -0.24887613, 0.34121621, 0.74450508, 0.99748651, 1.18231506, 1.01913448, 1.23264592, 1.1276437, 1.63161809, 1.29245711, 1.2137588, 1.30833272, 0.82524252, 0.43574915, 0.66905253, 0.17569382, 0.47281288, -0.38367952, -0.36729057, -0.83228366
	};
	std::vector<double> outY;

	Digital::FiltFilt sdfiltfilt;
	sdfiltfilt(b, a, x, outY);

	auto t_start = std::chrono::high_resolution_clock::now();
	sdfiltfilt(b, a, x, outY);
	auto t_end = std::chrono::high_resolution_clock::now();
	auto elapsed_time_ms_ = std::chrono::duration<double, std::milli>(t_end-t_start).count();

	std::cout << elapsed_time_ms_ << std::endl;	
}
